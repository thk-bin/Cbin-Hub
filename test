-- // thong bao
local Notification = require(game:GetService("ReplicatedStorage").Notification)
Notification.new("<Color=Green> CBin Hub Version <Color=/>"):Display()
wait(2)
Notification.new("<Color=Yellow> start up game...<Color=/>"):Display()
wait(3)
Notification.new("<Color=Yellow>start the Pet99 Backrooom rewards!<Color=/>"):Display()
wait(1)
Notification.new("<Color=Cyan>By Home_40<Color=/>"):Display()
wait(2)
Notification.new("<Color=Purple> Join Discord Me! <Color=/>"):Display()
wait(0.5)
Notification.new("<Color=Purple> CBin Hub | COMMUNITY <Color=/>"):Display()
wait(1)
-- // Fix Lag
for _,v in pairs(workspace:GetDescendants()) do
if v.ClassName == "Part"
or v.ClassName == "SpawnLocation"
or v.ClassName == "WedgePart"
or v.ClassName == "Terrain"
or v.ClassName == "MeshPart" then
v.Material = "Plastic"
end
end
-- // Globals
local ReS = game:GetService("ReplicatedStorage")
local RuS = game:GetService("RunService")
local TeS = game:GetService("TeleportService")
local Http = game:GetService("HttpService")
local Plyrs = game:GetService("Players")
-- // Locals
local Plyr ; local Lib
repeat RuS.Heartbeat:Wait()
    Plyr = Plyrs.LocalPlayer
    Lib = require(ReS.Library)
until (Plyr and Lib) ~= nil

local Active ; local Entrance
repeat RuS.Heartbeat:Wait()
    Active = workspace.__THINGS.__INSTANCE_CONTAINER.Active
    Entrance = workspace.__THINGS.Instances.Backrooms.Teleports.Enter
until (Active and Entrance) ~= nil and Entrance.BrickColor == BrickColor.new("Sand blue metallic")

local Hrp = Plyr.Character.HumanoidRootPart ; Hrp.CFrame = Entrance.CFrame ; local Spawn
repeat RuS.Heartbeat:Wait()
    pcall(function() Spawn = Active.Backrooms.GeneratedBackrooms.SpawnRoom end)
until Spawn ~= nil

local Exec = tick() ; local Rooms = {} ; local Counter = 0 ; local Claimed = 0
for _,room in workspace.__THINGS.__INSTANCE_CONTAINER.Active.Backrooms.GeneratedBackrooms:GetChildren() do
    local Reward = room:FindFirstChild("RandomReward")
    local UID = room:GetAttribute("RoomUID")
    if Reward and (Reward.Animated.Top.Transparency and Reward.Animated.Bottom.Transparency) ~= 1 then
        Counter = Counter + 1
        if not Rooms[UID] then
            Rooms[UID] = room
        end
    end
end

workspace.__THINGS.__INSTANCE_CONTAINER.Active.Backrooms.GeneratedBackrooms.ChildAdded:Connect(function(room)
    local Reward = room:FindFirstChild("RandomReward")
    local UID = room:GetAttribute("RoomUID")
    if Reward and (Reward.Animated.Top.Transparency and Reward.Animated.Bottom.Transparency) ~= 1 then
        if not Rooms[UID] then
            Rooms[UID] = room
        end
    end
end)

print("Initially Found x"..tostring(Counter), "RandomRewards")

while next(Rooms) do task.wait()
    for _,room in Rooms do
        local Reward = room:FindFirstChild("RandomReward")
        local UID = room:GetAttribute("RoomUID")
        if Reward and (Reward.Animated.Top.Transparency and Reward.Animated.Bottom.Transparency) ~= 1 then
            local start = tick()
            repeat task.wait(.3)
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = room.RandomReward.Main.CFrame
                local Success,Reason = Lib.Network.Invoke("Instancing_InvokeCustomFromClient", "Backrooms", "AbstractRoom_InvokeServer", room:GetAttribute("RoomUID"), "ClaimRandomReward", Reward)
            until Success or not Success and Reason ~= "You are claiming this too fast!"
            Claimed = Claimed + 1
            print("Claimed "..tostring(Claimed).."x Rewards in "..tostring(tick() - start).."s, in serv for "..tostring(tick() - Exec).."s")
            Rooms[UID] = nil
        end
    end
end
